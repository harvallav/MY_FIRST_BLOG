{
  "hash": "f83a816c91007fc743dd83b3bb4ceff1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"COUNTS\"\nauthor: Harvallav\n---\n\n\n\n## DAY 3\n\nHello guys.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(tidy = \"formatr\", tidy.opts = list(blank = FALSE, width.cutoff = 30))\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\nlibrary(skimr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi <- read_csv(\"https://vincentarelbundock.github.io/Rdatasets/csv/modeldata/taxi.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 10000 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): tip, company, local, dow, month\ndbl (3): rownames, distance, hour\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ntaxi\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10,000 × 8\n   rownames tip   distance company                      local dow   month  hour\n      <dbl> <chr>    <dbl> <chr>                        <chr> <chr> <chr> <dbl>\n 1        1 yes      17.2  Chicago Independents         no    Thu   Feb      16\n 2        2 yes       0.88 City Service                 yes   Thu   Mar       8\n 3        3 yes      18.1  other                        no    Mon   Feb      18\n 4        4 yes      20.7  Chicago Independents         no    Mon   Apr       8\n 5        5 yes      12.2  Chicago Independents         no    Sun   Mar      21\n 6        6 yes       0.94 Sun Taxi                     yes   Sat   Apr      23\n 7        7 yes      17.5  Flash Cab                    no    Fri   Mar      12\n 8        8 yes      17.7  other                        no    Sun   Jan       6\n 9        9 yes       1.85 Taxicab Insurance Agency Llc no    Fri   Apr      12\n10       10 yes       1.47 City Service                 no    Tue   Mar      14\n# ℹ 9,990 more rows\n```\n\n\n:::\n:::\n\n\n\n### GLIMPSE, SKIM AND INSPECT !\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskimr::skim(taxi)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |      |\n|:------------------------|:-----|\n|Name                     |taxi  |\n|Number of rows           |10000 |\n|Number of columns        |8     |\n|_______________________  |      |\n|Column type frequency:   |      |\n|character                |5     |\n|numeric                  |3     |\n|________________________ |      |\n|Group variables          |None  |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|tip           |         0|             1|   2|   3|     0|        2|          0|\n|company       |         0|             1|   5|  28|     0|        7|          0|\n|local         |         0|             1|   2|   3|     0|        2|          0|\n|dow           |         0|             1|   3|   3|     0|        7|          0|\n|month         |         0|             1|   3|   3|     0|        4|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|      sd| p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|-------:|--:|-------:|-------:|-------:|-------:|:-----|\n|rownames      |         0|             1| 5000.50| 2886.90|  1| 2500.75| 5000.50| 7500.25| 10000.0|▇▇▇▇▇ |\n|distance      |         0|             1|    6.22|    7.38|  0|    0.94|    1.78|   15.56|    42.3|▇▁▂▁▁ |\n|hour          |         0|             1|   14.18|    4.36|  0|   11.00|   15.00|   18.00|    23.0|▁▃▅▇▃ |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(taxi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10,000\nColumns: 8\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ tip      <chr> \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\"…\n$ distance <dbl> 17.19, 0.88, 18.11, 20.70, 12.23, 0.94, 17.47, 17.67, 1.85, 1…\n$ company  <chr> \"Chicago Independents\", \"City Service\", \"other\", \"Chicago Ind…\n$ local    <chr> \"no\", \"yes\", \"no\", \"no\", \"no\", \"yes\", \"no\", \"no\", \"no\", \"no\",…\n$ dow      <chr> \"Thu\", \"Thu\", \"Mon\", \"Mon\", \"Sun\", \"Sat\", \"Fri\", \"Sun\", \"Fri\"…\n$ month    <chr> \"Feb\", \"Mar\", \"Feb\", \"Apr\", \"Mar\", \"Apr\", \"Mar\", \"Jan\", \"Apr\"…\n$ hour     <dbl> 16, 8, 18, 8, 21, 23, 12, 6, 12, 14, 18, 11, 12, 19, 17, 13, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninspect(taxi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n     name     class levels     n missing\n1     tip character      2 10000       0\n2 company character      7 10000       0\n3   local character      2 10000       0\n4     dow character      7 10000       0\n5   month character      4 10000       0\n                                   distribution\n1 yes (92.1%), no (7.9%)                       \n2 other (27.1%) ...                            \n3 no (81.2%), yes (18.8%)                      \n4 Thu (19.6%), Wed (17.5%), Tue (16.3%) ...    \n5 Apr (31.8%), Mar (31.4%), Feb (20.4%) ...    \n\nquantitative variables:  \n      name   class min      Q1  median        Q3     max        mean\n1 rownames numeric   1 2500.75 5000.50 7500.2500 10000.0 5000.500000\n2 distance numeric   0    0.94    1.78   15.5625    42.3    6.224144\n3     hour numeric   0   11.00   15.00   18.0000    23.0   14.177300\n           sd     n missing\n1 2886.895680 10000       0\n2    7.381397 10000       0\n3    4.359904 10000       0\n```\n\n\n:::\n:::\n\n\n## DATA MUNGING\nWe will keep the target variable tip in mind at all times. And convert the dow, local and month variables into factors beforehand.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Convert `dow`, `local`, and `month` into ordered factors\ntaxi_modified <- taxi %>%\n  mutate(\n    dow = factor(dow,\n      levels = c(\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"),\n      labels = c(\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"),\n      ordered = TRUE\n    ),\n    ##\n    local = factor(local,\n      levels = c(\"no\", \"yes\"),\n      labels = c(\"no\", \"yes\"),\n      ordered = TRUE\n    ),\n    ##\n    month = factor(month,\n      levels = c(\"Jan\", \"Feb\", \"Mar\", \"Apr\"),\n      labels = c(\"Jan\", \"Feb\", \"Mar\", \"Apr\"),\n      ordered = TRUE\n    )\n  )\ntaxi_modified %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 10,000\nColumns: 8\n$ rownames <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ tip      <chr> \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\"…\n$ distance <dbl> 17.19, 0.88, 18.11, 20.70, 12.23, 0.94, 17.47, 17.67, 1.85, 1…\n$ company  <chr> \"Chicago Independents\", \"City Service\", \"other\", \"Chicago Ind…\n$ local    <ord> no, yes, no, no, no, yes, no, no, no, no, no, no, no, yes, no…\n$ dow      <ord> Thu, Thu, Mon, Mon, Sun, Sat, Fri, Sun, Fri, Tue, Tue, Sun, W…\n$ month    <ord> Feb, Mar, Feb, Apr, Mar, Apr, Mar, Jan, Apr, Mar, Mar, Apr, A…\n$ hour     <dbl> 16, 8, 18, 8, 21, 23, 12, 6, 12, 14, 18, 11, 12, 19, 17, 13, …\n```\n\n\n:::\n:::\n\n\n\n### QUESTION : Do more people tip than not?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_bar(~tip, data = taxi_modified) %>%\n  gf_labs(title = \"Plot 1A: Counts of Tips\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(taxi_modified) +\n  geom_bar(aes(x = tip)) +\n  labs(title = \"Plot 1A: Counts of Tips\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n#### what really is the difference between both the plots ?\n\nggplot: Great for advanced users who want to create detailed and complex plots with lots of customization options.\n\nggformula: Ideal for beginners looking for a simpler way to make basic plots quickly, using an easy formula-based approach, but with less customization.\n\n### QUESTION: Does the tip depend upon whether the trip is local or not?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modified %>% \n  gf_bar(~ local, fill = ~ tip, \n         position = \"dodge\") %>% \n  gf_labs(title = \"Dodged Bar Chart\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nIt plots the counts of taxi rides for each local category (like different pickup locations) and uses different colors to represent different tip levels (whether they gave a tip or not).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Set graph theme\n# theme_set(new = theme_custom())\n#\n## Showing \"per capita\" percentages\n## Better labelling of Y-axis\ntaxi_modified %>%\n  gf_props(~company,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 2D: Filled Bar Chart\",\n    subtitle = \"Shows Per group differences in Proportions!\"\n  ) %>%\n  gf_theme(theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modified %>%\n  gf_bar(~local,\n    fill = ~tip,\n    position = \"stack\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 2B: Stacked Bar Chart\",\n    subtitle = \"Can we spot per group differences in proportions??\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nthe graph above is positioning it in stack whereas the one below uses fill for the group differences in proportions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Showing \"per capita\" percentages\ntaxi_modified %>%\n  gf_bar(~local,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 2C: Filled Bar Chart\",\n    subtitle = \"Shows Per group differences in Proportions!\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\ngf_props() is specifically designed to calculate and display proportions directly so you can use that too , like states below:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Better labelling of Y-axis\ntaxi_modified %>%\n  gf_props(~local,\n    fill = ~tip,\n    position = \"fill\"\n  ) %>%\n  gf_labs(\n    title = \"Plot 2D: Filled Bar Chart\",\n    subtitle = \"Shows Per group differences in Proportions!\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n### QUESTION: Do some cab company-ies get more tips than others?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntaxi_modified %>% \n  gf_bar(~ company, fill = ~ tip, position = \"dodge\") %>% \n  gf_labs(title = \"Plot 2A: Dodged Bar Chart\") %>% \n  gf_theme(theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n##\ntaxi_modified %>% \n  gf_bar(~ company, fill = ~ tip, position = \"stack\") %>% \n  gf_labs(title = \"Plot 2B: Stacked Bar Chart\",\n          subtitle = \"Can we spot per group differences in proportions??\") %>% \n  gf_theme(theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n```{.r .cell-code}\n## Showing \"per capita\" percentages\ntaxi_modified %>% \n  gf_bar(~ company, fill = ~ tip, position = \"fill\") %>% \n  gf_labs(title = \"Plot 2C: Filled Bar Chart\",\n          subtitle = \"Shows Per group differences in Proportions!\") %>% \n  gf_theme(theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n\n```{.r .cell-code}\n## Showing \"per capita\" percentages\n## Better labelling of Y-axis\ntaxi_modified %>% \n  gf_props(~ company, fill = ~ tip, position = \"fill\") %>% \n  gf_labs(title = \"Plot 2D: Filled Bar Chart\",\n          subtitle = \"Shows Per group differences in Proportions!\") %>% \n  gf_theme(theme(axis.text.x = element_text(size = 6, angle = 45, hjust = 1)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-4.png){width=672}\n:::\n:::\n\n\n\nThe Dodged Bar Chart compares counts of rides for each taxi company with different tip levels shown side by side, making it easy to see differences between tips.\n\nThe Stacked Bar Chart combines these counts into a single bar per company, allowing viewers to assess total rides and the proportion of each tip level within that total.\n\n\n\n### QUESTION: Does a tip depend upon the distance, hour of day, and dow and month?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_bar(~ hour, fill = ~ tip, data = taxi_modified) %>%\n  gf_labs(title = \"Plot B: Counts of Tips by Hour\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\n##\ngf_bar(~ dow, fill = ~ tip, data = taxi_modified) %>%\n  gf_labs(title = \"Plot C: Counts of Tips by Day of Week\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n\n```{.r .cell-code}\n##\ngf_bar(~ month, fill = ~ tip, data = taxi_modified) %>%\n  gf_labs(title = \"Plot D: Counts of Tips by Month\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-3.png){width=672}\n:::\n\n```{.r .cell-code}\n##\ngf_bar(~ month | dow, fill = ~ tip, data = taxi_modified) %>%\n  gf_labs(title = \"Plot E: Counts of Tips by Day of Week and Month\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-4.png){width=672}\n:::\n\n```{.r .cell-code}\n##\n## This may be too busy a graph...\ngf_bar(~ dow | hour, fill = ~ tip, data = taxi_modified) %>%\n  gf_labs(title = \"Plot F: Counts of Tips by Hour and Day of Week\",\n          subtitle = \"Is this plot arrangement easy to grasp?\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-5.png){width=672}\n:::\n\n```{.r .cell-code}\n## This is better!\ngf_bar(~ hour | dow, fill = ~ tip, data = taxi) %>%\n  gf_labs(title = \"Plot G: Counts of Tips by Hour and Day of Week\",\n          subtitle = \"Swapped the Facets\")  \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-6.png){width=672}\n:::\n:::\n\n\n\n\n#### Plot B: Counts of Tips by Hour\nThe tip counts are shown in this bar chart throughout the day, with different colors denoting different tip levels. By showing which hours receive higher or lower tips, it assists in identifying patterns in tipping behavior at various times.\n\n#### Plot C: Counts of Tips by Day of Week\nUsing color to indicate different tip levels, this chart shows the counts of tips according to the day of the week. It makes it possible to analyze tipping patterns over the course of several days and identify any differences in tipping patterns.\n\n#### Plot D: Counts of Tips by Month\nThis chart shows the counts of tips received for each month, with bars filled according to tip levels. It helps visualize seasonal trends in tipping behavior, revealing how tips may vary from month to month.\n\n#### Plot E: Counts of Tips by Day of Week and Month\nThis faceted chart displays the counts of tips for each month, separated by day of the week, with colors indicating tip levels. It provides a detailed view of tipping patterns, allowing for comparisons across days and months simultaneously.\n\n#### Plot F: Counts of Tips by Hour and Day of Week\nThis chart shows counts of tips based on both hour and day of the week, organized with facets for each hour. It may be visually complex, prompting viewers to consider whether this arrangement effectively conveys the data patterns.\n\n#### Plot G: Counts of Tips by Hour and Day of Week (Swapped Facets)\nThis chart is similar to the previous one but swaps the facets, displaying counts of tips by hour across different days of the week. This layout aims to provide clearer insights, making it easier to grasp tipping patterns by hour for each day.\n\n## Plotting Proportions and Percentages using gf_props\nThis chart displays the proportions(first graph below) and percentage(second graph after that) of different substance use, categorized by sex, with bars positioned side by side (dodged) for easy comparison. It helps visualize the distribution of substance use across genders, highlighting any differences in proportions between them.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_props(~substance,\n  data = mosaicData::HELPrct, fill = ~sex,\n  position = \"dodge\"\n) %>%\n  gf_labs(title = \"Plotting Proportions using gf_props\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_percents(~substance,\n  data = mosaicData::HELPrct, fill = ~sex,\n  position = \"dodge\"\n) %>%\n  gf_refine(\n    scale_y_continuous(\n      labels = scales::label_percent(scale = 1)\n    )\n  ) %>%\n  gf_labs(title = \"Plotting Percentages using gf_percents\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}